(in-package :cl-user)
(defpackage clml-svm-test
  (:use :cl
        :svm
        :prove))
(in-package :clml-svm-test)

;; NOTE: To run this test file, execute `(asdf:test-system :clml-svm)' in your Lisp.

(defparameter a1a-dim 123)
(defvar a1a-train)
(defvar a1a-test)

(plan nil)

(defun approximately-equal (x y &optional (delta 0.001d0))
  (flet ((andf (x y) (and x y))
         (close? (x y) (< (abs (- x y)) delta)))
    (etypecase x
      (double-float (close? x y))
      (vector (reduce #'andf (map 'vector #'close? x y)))
      (list (reduce #'andf (mapcar #'close? x y))))))

;; Test1: read libsvm dataset
(is (progn
      (setf a1a-train
	    (read-libsvm-data (merge-pathnames
			       #P"t/dataset/a1a"
			       (asdf:system-source-directory :clml-svm))
			      a1a-dim 1605))
      (aref a1a-train 0))
    #(0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0
      1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0
      0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0
      0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 1.0d0 1.0d0 0.0d0 0.0d0
      0.0d0 1.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 -1.0d0)
    :test #'equalp)

(is (progn
      (setf a1a-test
	    (read-libsvm-data (merge-pathnames
			       #P"t/dataset/a1a.t"
			       (asdf:system-source-directory :clml-svm))
			      a1a-dim 30956))
      (aref a1a-test 0))
    #(0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0
      1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0
      0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 1.0d0 0.0d0 1.0d0 0.0d0 1.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 1.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 -1.0d0)
    :test #'equalp)

(defparameter kernel (make-rbf-kernel :gamma (expt 2d0 -7d0)))

;; Training
(defparameter a1a-model (make-svm-model a1a-train kernel :c (expt 2d0 3d0)))

(is (svm::alpha-array-of a1a-model)
    #(8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      8.0d0 4.978998136005218d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 4.744873603796927d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      3.0718234160880584d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 2.1112970015521686d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0
      0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      3.720450653339135d0 0.0d0 0.0d0 2.266167436693199d0 8.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 4.6133396456772795d0 8.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 6.193796986865621d0 0.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 2.92283888753194d0
      0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0
      7.432519542713897d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      5.087828174149966d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 8.0d0
      8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 7.348735779566676d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      1.615211298802183d0 0.0d0 0.0d0 0.0d0 0.0d0 3.3017385271214437d0
      5.082840589141947d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0
      8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      5.395513064704837d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      0.05799487668090476d0 8.0d0 8.0d0 0.0d0 2.4014760447038523d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      4.3119493931325685d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.1559738345403859d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 8.0d0 4.496693841082883d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 5.357269614585726d0
      8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 2.7050029525090595d0 0.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      2.4878490846132717d0 8.0d0 1.3062572356092317d0 2.9313891955630935d0 8.0d0
      0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 2.508158025790117d0
      8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 1.9988922347658176d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 1.3988119541592712d0 0.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 4.6973053857505755d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 0.628375070364874d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      5.207775987819231d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      4.557681939332225d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 5.807951795946134d0 0.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 7.501690447213697d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 1.8275539497626891d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 5.62363578173651d0 1.7857858709042427d0 8.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 1.0433804388805779d0
      8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 6.295946171344873d0 0.0d0 0.0d0
      0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 4.918359912034439d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      5.9586906509276805d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 6.030254447181311d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      5.675915449016086d0 0.0d0 0.0d0 8.0d0 1.3309395955755694d0
      3.9414246427295816d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 6.4984617528071045d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 5.142003486110617d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 3.722963056521982d0 8.0d0 0.0d0
      3.757718059271347d0 3.805791214166886d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 8.0d0 1.609412820582141d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      1.7446079599125464d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.7018014459982056d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 1.9282358789944931d0 8.0d0 0.0d0 8.0d0 0.0d0
      6.559810845243947d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 6.565427928833169d0 8.0d0 0.0d0 8.0d0 8.0d0 1.0548087539271922d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 5.672851450153982d0 8.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      5.917014578950236d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 7.076829668407334d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0
      8.0d0 5.1052059368115925d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      3.6981507465058936d0 3.741569758957743d0 0.0d0 0.0d0 0.0d0 0.0d0
      3.107845774569921d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 2.861472996139779d0 0.0d0
      8.0d0 0.0d0 8.0d0 0.0d0 8.0d0 8.0d0 8.0d0 1.0074357235570701d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0
      8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 8.0d0 2.2666303615629615d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0
      8.0d0 0.0d0 0.0d0 0.7324521610723671d0 8.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0
      0.0d0 4.68911039386066d0 8.0d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0
      8.0d0 8.0d0 0.0d0 8.0d0 8.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 0.0d0 1.1632711364813717d0 0.0d0 8.0d0 8.0d0
      0.0d0 0.0d0 8.0d0 1.4526519821655342d0 8.0d0 8.0d0 0.0d0 8.0d0 0.0d0 8.0d0
      0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0 8.0d0 0.0d0 8.0d0 0.0d0 0.0d0 0.0d0
      0.0d0 0.0d0)
    :test #'approximately-equal)

;; Test
(is (svm-validation a1a-model a1a-test)
    '(((-1.0d0 . 1.0d0) . 3186) ((1.0d0 . 1.0d0) . 4260) ((-1.0d0 . -1.0d0) . 21871)
      ((1.0d0 . -1.0d0) . 1639))
    :test #'equalp)

(finalize)
